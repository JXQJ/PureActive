// ***********************************************************************
// Assembly         : PureActive.Network.Devices
// Author           : SteveBu
// Created          : 11-02-2018
// License          : Licensed under MIT License, see https://github.com/PureActive/PureActive/blob/master/LICENSE
//
// Last Modified By : SteveBu
// Last Modified On : 11-20-2018
// ***********************************************************************
// <copyright file="NetworkDeviceBase.cs" company="BushChang Corporation">
//     © 2018 BushChang Corporation. All rights reserved.
// </copyright>
// <summary></summary>
// ***********************************************************************
using PureActive.Logging.Abstractions.Interfaces;
using PureActive.Network.Abstractions.CommonNetworkServices;
using PureActive.Network.Abstractions.NetworkDevice;
using PureActive.Network.Abstractions.Types;
using PureActive.Network.Devices.Computer;
using PureActive.Network.Devices.Device;

namespace PureActive.Network.Devices.Network
{
    /// <summary>
    /// Class NetworkDeviceBase.
    /// Implements the <see cref="PureActive.Network.Devices.Device.DeviceBase" />
    /// Implements the <see cref="PureActive.Network.Abstractions.NetworkDevice.INetworkDevice" />
    /// </summary>
    /// <seealso cref="PureActive.Network.Devices.Device.DeviceBase" />
    /// <seealso cref="PureActive.Network.Abstractions.NetworkDevice.INetworkDevice" />
    /// <autogeneratedoc />
    public class NetworkDeviceBase : DeviceBase, INetworkDevice
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="NetworkDeviceBase"/> class.
        /// </summary>
        /// <param name="commonNetworkServices">The common network services.</param>
        /// <param name="deviceType">Type of the device.</param>
        /// <param name="logger">The logger.</param>
        /// <autogeneratedoc />
        public NetworkDeviceBase(ICommonNetworkServices commonNetworkServices,
            DeviceType deviceType = DeviceType.UnknownDevice, IPureLogger logger = null) :
            base(commonNetworkServices, deviceType, logger)
        {
            CommonNetworkServices = commonNetworkServices;
        }

        /// <summary>
        /// Gets the common network services.
        /// </summary>
        /// <value>The common network services.</value>
        /// <autogeneratedoc />
        public ICommonNetworkServices CommonNetworkServices { get; }

        /// <summary>
        /// Networks the type of the device from.
        /// </summary>
        /// <param name="commonNetworkServices">The common network services.</param>
        /// <param name="deviceType">Type of the device.</param>
        /// <returns>INetworkDevice.</returns>
        /// <autogeneratedoc />
        public static INetworkDevice NetworkDeviceFromType(ICommonNetworkServices commonNetworkServices,
            DeviceType deviceType)
        {
            switch (deviceType)
            {
                case DeviceType.LocalComputer:
                {
                    return new LocalComputer(commonNetworkServices, DeviceType.LocalComputer);
                }
            }

            return new NetworkDeviceBase(commonNetworkServices, deviceType,
                commonNetworkServices.LoggerFactory.CreatePureLogger<NetworkDeviceBase>());
        }
    }
}